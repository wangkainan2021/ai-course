<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå­¦ä¹ è¯¾ç¨‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', 'SimHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }


        /* æ­¥éª¤æŒ‡ç¤ºå™¨ */
        .steps-indicator {
            display: flex;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            gap: 20px;
            flex-wrap: wrap;
        }

        .step-item {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            cursor: pointer;
            font-weight: bold;
            font-size: 20px;
        }

        .step-item.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .step-item.completed {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        /* å†…å®¹åŒºåŸŸ */
        .content-area {
            padding: 40px;
            min-height: 500px;
        }

        .level-container {
            display: none;
            animation: fadeIn 0.5s;
        }

        .level-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* å›¾ç‰‡å…³å¡æ ·å¼ */
        .image-gallery {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto 30px;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            aspect-ratio: 16 / 9;
        }

        .image-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: none;
        }

        .gallery-image.active {
            display: block;
        }

        .gallery-nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            z-index: 10;
        }

        .gallery-nav-button.prev {
            left: 20px;
        }

        .gallery-nav-button.next {
            right: 20px;
        }

        .gallery-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .gallery-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
        }

        .gallery-indicator.active {
            background: #667eea;
        }

        /* è§†é¢‘å…³å¡æ ·å¼ */
        .video-container {
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
            position: relative;
            padding-top: 56.25%;
        }

        .video-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .video-wrapper video {
            width: 100%;
            height: 100%;
        }

        /* Canvaså…³å¡æ ·å¼ */
        .canvas-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            min-height: 400px;
        }

        .canvas-wrapper {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        /* æ–‡æœ¬è¯´æ˜åŒºåŸŸ */
        .text-area {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            margin-bottom: 30px;
        }

        .text-area h3 {
            color: #333;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .text-content {
            color: #555;
            font-size: 16px;
            line-height: 1.8;
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .error {
            text-align: center;
            padding: 60px 20px;
            color: #c33;
            background: #fee;
            border-radius: 12px;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .content-area {
                padding: 20px;
            }

            .steps-indicator {
                gap: 10px;
            }

            .step-item {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
        <div class="steps-indicator" id="stepsIndicator">
            <!-- åŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <div class="content-area" id="contentArea">
            <div class="loading">åŠ è½½ä¸­...</div>
        </div>
    </div>

    <script>
        // è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå¹¶è®¾ç½®APIåœ°å€
        // å¦‚æœæ˜¯æœ¬åœ°å¼€å‘ç¯å¢ƒï¼ˆlocalhost æˆ– 127.0.0.1ï¼‰ï¼Œä½¿ç”¨æœ¬åœ°åç«¯
        // å¦åˆ™ä½¿ç”¨çº¿ä¸Šåç«¯ï¼ˆéœ€è¦éƒ¨ç½²åç«¯æœåŠ¡ï¼‰
        // æ³¨æ„ï¼šfile:// åè®®ï¼ˆç›´æ¥æ‰“å¼€æœ¬åœ°æ–‡ä»¶ï¼‰ä¹Ÿä½¿ç”¨çº¿ä¸Šåç«¯
        const hostname = window.location.hostname;
        const isLocal = (hostname === 'localhost' || hostname === '127.0.0.1') && 
                       window.location.protocol !== 'file:';
        
        // çº¿ä¸Šåç«¯åœ°å€ï¼ˆéƒ¨ç½²åç«¯åéœ€è¦ä¿®æ”¹è¿™é‡Œï¼‰
        const PRODUCTION_API_URL = 'https://backend-topaz-zeta-46.vercel.app/api';
        
        const API_BASE_URL = isLocal 
            ? 'http://localhost:3000/api' 
            : PRODUCTION_API_URL;
        
        console.log('å½“å‰ç¯å¢ƒ:', isLocal ? 'æœ¬åœ°å¼€å‘' : 'çº¿ä¸Šç”Ÿäº§');
        console.log('APIåœ°å€:', API_BASE_URL);
        
        let currentCourse = null;
        let currentLevelIndex = 0;
        let currentImageIndex = 0;

        // åˆå§‹åŒ–
        async function init() {
            try {
                // è·å–è¯¾ç¨‹åˆ—è¡¨ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªè¯¾ç¨‹ï¼‰
                const coursesRes = await fetch(`${API_BASE_URL}/courses`);
                const coursesData = await coursesRes.json();
                
                if (coursesData.success) {
                    if (coursesData.data.length > 0) {
                        currentCourse = coursesData.data[0];
                        loadCourse(currentCourse);
                    } else {
                        // æ•°æ®ä¸ºç©ºï¼Œæç¤ºåˆå§‹åŒ–
                        let msg = 'æš‚æ— è¯¾ç¨‹æ•°æ®';
                        if (!isLocal) {
                            msg += '<br><br>è¯·ä½¿ç”¨"åˆå§‹åŒ–æ•°æ®å·¥å…·.html"åˆå§‹åŒ–æ•°æ®åˆ° Vercel åç«¯';
                        } else {
                            msg += '<br><br>è¯·åœ¨ç®¡ç†ç«¯åˆ›å»ºè¯¾ç¨‹å’Œå…³å¡';
                        }
                        showError(msg);
                    }
                } else {
                    showError('è·å–è¯¾ç¨‹å¤±è´¥ï¼š' + (coursesData.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                console.error('APIåœ°å€:', API_BASE_URL);
                console.error('é”™è¯¯è¯¦æƒ…:', error.message);
                
                // æ›´è¯¦ç»†çš„é”™è¯¯æç¤º
                let errorMsg = 'åŠ è½½è¯¾ç¨‹å¤±è´¥';
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    errorMsg += 'ï¼šæ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡';
                    if (!isLocal) {
                        errorMsg += '<br><br>çº¿ä¸Šç¯å¢ƒæç¤ºï¼š<br>1. è¯·ç¡®ä¿å·²ä½¿ç”¨"åˆå§‹åŒ–æ•°æ®å·¥å…·.html"åˆå§‹åŒ–æ•°æ®<br>2. åç«¯åœ°å€ï¼š' + PRODUCTION_API_URL;
                    } else {
                        errorMsg += '<br><br>æœ¬åœ°ç¯å¢ƒæç¤ºï¼š<br>1. è¯·ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆcd backend && npm startï¼‰<br>2. æœåŠ¡åº”è¿è¡Œåœ¨ http://localhost:3000';
                    }
                } else {
                    errorMsg += 'ï¼š' + error.message;
                }
                showError(errorMsg);
            }
        }

        // åŠ è½½è¯¾ç¨‹
        async function loadCourse(course) {
            if (!course || !course.levelIds || course.levelIds.length === 0) {
                showError('è¯¾ç¨‹ä¸­æ²¡æœ‰å…³å¡');
                return;
            }

            // ç”Ÿæˆæ­¥éª¤æŒ‡ç¤ºå™¨
            generateStepsIndicator(course.levelIds.length);

            // åŠ è½½ç¬¬ä¸€ä¸ªå…³å¡
            await loadLevel(0);
        }

        // ç”Ÿæˆæ­¥éª¤æŒ‡ç¤ºå™¨
        function generateStepsIndicator(count) {
            const indicator = document.getElementById('stepsIndicator');
            indicator.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const step = document.createElement('div');
                step.className = 'step-item' + (i === 0 ? ' active' : '');
                step.textContent = i + 1;
                step.onclick = () => goToLevel(i);
                indicator.appendChild(step);
            }
        }

        // è·³è½¬åˆ°æŒ‡å®šå…³å¡
        async function goToLevel(index) {
            if (!currentCourse || index < 0 || index >= currentCourse.levelIds.length) {
                return;
            }

            currentLevelIndex = index;
            await loadLevel(index);
            
            // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            document.querySelectorAll('.step-item').forEach((item, i) => {
                item.classList.remove('active', 'completed');
                if (i < index) {
                    item.classList.add('completed');
                } else if (i === index) {
                    item.classList.add('active');
                }
            });
        }

        // åŠ è½½å…³å¡
        async function loadLevel(index) {
            const levelId = currentCourse.levelIds[index];
            
            try {
                const levelRes = await fetch(`${API_BASE_URL}/levels/${levelId}`);
                const levelData = await levelRes.json();
                
                if (levelData.success) {
                    renderLevel(levelData.data);
                } else {
                    showError('åŠ è½½å…³å¡å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½å…³å¡å¤±è´¥:', error);
                showError('åŠ è½½å…³å¡å¤±è´¥');
            }
        }

        // æ¸²æŸ“å…³å¡
        async function renderLevel(level) {
            const contentArea = document.getElementById('contentArea');
            
            let html = '';
            let canvasCode = null;
            let blobUrl = null;
            
            if (level.type === 'image') {
                html = renderImageLevel(level);
            } else if (level.type === 'video') {
                html = renderVideoLevel(level);
            } else if (level.type === 'canvas') {
                const result = await renderCanvasLevel(level);
                html = result.html;
                canvasCode = result.code;
                blobUrl = result.blobUrl; // ä¿å­˜blob URLä»¥ä¾¿åç»­æ¸…ç†
            } else if (level.type === 'quiz') {
                html = renderQuizLevel(level);
            }
            
            contentArea.innerHTML = html;
            
            // å¦‚æœæ˜¯Canvaså…³å¡ä¸”æ˜¯HTMLæ–‡æ¡£ï¼ˆä½¿ç”¨iframeï¼‰ï¼Œä¸éœ€è¦æ‰§è¡Œä»£ç 
            if (level.type === 'canvas' && blobUrl) {
                // HTMLæ–‡æ¡£å·²ç»åœ¨iframeä¸­åŠ è½½ï¼Œä¸éœ€è¦é¢å¤–å¤„ç†
                console.log('HTMLæ–‡æ¡£å·²åœ¨iframeä¸­åŠ è½½');
                return;
            }
            
            // å¦‚æœæ˜¯Canvaså…³å¡ï¼Œæ‰§è¡Œä»£ç 
            if (level.type === 'canvas' && canvasCode) {
                const canvasId = `canvas-${level.id}`;
                // ä½¿ç”¨æ›´å¯é çš„æ–¹å¼ç­‰å¾…canvaså…ƒç´ å‡†å¤‡å¥½
                const executeCanvasCode = () => {
                    const canvas = document.getElementById(canvasId);
                    if (canvas) {
                        try {
                            const ctx = canvas.getContext('2d');
                            
                            // æ¸…ç†ä»£ç ï¼šç§»é™¤å¯èƒ½çš„BOMæ ‡è®°å’Œå¤šä½™çš„ç©ºç™½
                            let cleanCode = canvasCode.trim();
                            
                            // è¾“å‡ºè°ƒè¯•ä¿¡æ¯
                            console.log('å‡†å¤‡æ‰§è¡ŒCanvasä»£ç ï¼Œä»£ç é•¿åº¦:', cleanCode.length);
                            console.log('ä»£ç å‰100å­—ç¬¦:', cleanCode.substring(0, 100));
                            
                            // ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥è€Œä¸æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œé¿å…ä»£ç ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¯¼è‡´è¯­æ³•é”™è¯¯
                            // å°†ä»£ç ä½œä¸ºFunctionæ„é€ å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼ˆå‡½æ•°ä½“ï¼‰
                            // ä½¿ç”¨æ•°ç»„æ‹¼æ¥æ¥æ„å»ºå‡½æ•°ä½“å­—ç¬¦ä¸²ï¼Œé¿å…æ¨¡æ¿å­—ç¬¦ä¸²çš„é—®é¢˜
                            const functionBodyParts = [
                                'try {',
                                cleanCode,
                                '} catch (e) {',
                                '    console.error(\'ä»£ç å†…éƒ¨é”™è¯¯:\', e);',
                                '    throw e;',
                                '}'
                            ];
                            
                            // åˆ›å»ºå‡½æ•°ï¼Œcanvaså’Œctxä½œä¸ºå‚æ•°
                            const scopeFunction = new Function('canvas', 'ctx', functionBodyParts.join('\n'));
                            
                            // æ‰§è¡Œä»£ç 
                            scopeFunction(canvas, ctx);
                            
                            console.log('Canvasä»£ç æ‰§è¡ŒæˆåŠŸ');
                        } catch (error) {
                            console.error('Canvasä»£ç æ‰§è¡Œé”™è¯¯:', error);
                            console.error('é”™è¯¯åç§°:', error.name);
                            console.error('é”™è¯¯æ¶ˆæ¯:', error.message);
                            console.error('é”™è¯¯å †æ ˆ:', error.stack);
                            console.error('ä»£ç å‰200å­—ç¬¦:', canvasCode.substring(0, 200));
                            console.error('å®Œæ•´ä»£ç :', canvasCode);
                            
                            // å°è¯•æ˜¾ç¤ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
                            try {
                                const ctx = canvas.getContext('2d');
                                ctx.fillStyle = '#f0f0f0';
                                ctx.fillRect(0, 0, canvas.width, canvas.height);
                                ctx.fillStyle = '#c33';
                                ctx.font = '14px Arial';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                
                                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                                const errorMsg = error.name + ': ' + error.message;
                                const errorLines = errorMsg.match(/.{1,50}/g) || [errorMsg];
                                
                                // å¦‚æœé”™è¯¯ä¿¡æ¯å¤ªé•¿ï¼Œåªæ˜¾ç¤ºå‰å‡ è¡Œ
                                const maxLines = 5;
                                const displayLines = errorLines.slice(0, maxLines);
                                
                                displayLines.forEach((line, i) => {
                                    ctx.fillText(line, canvas.width / 2, canvas.height / 2 - (displayLines.length - 1) * 12 + i * 24);
                                });
                                
                                if (errorLines.length > maxLines) {
                                    ctx.fillText('...', canvas.width / 2, canvas.height / 2 + (maxLines - 1) * 12 + 24);
                                }
                                
                                // æ˜¾ç¤ºæç¤ºä¿¡æ¯
                                ctx.fillStyle = '#666';
                                ctx.font = '12px Arial';
                                ctx.fillText('è¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯', canvas.width / 2, canvas.height / 2 + (maxLines + 1) * 12 + 24);
                            } catch (renderError) {
                                console.error('æ¸²æŸ“é”™è¯¯ä¿¡æ¯å¤±è´¥:', renderError);
                            }
                        }
                    } else {
                        // å¦‚æœcanvasè¿˜æ²¡å‡†å¤‡å¥½ï¼Œå†ç­‰ä¸€ä¼šå„¿
                        setTimeout(executeCanvasCode, 50);
                    }
                };
                
                // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå·²æ›´æ–°
                setTimeout(executeCanvasCode, 200);
            }
            
            // å¦‚æœæ˜¯å›¾ç‰‡å…³å¡ï¼Œåˆå§‹åŒ–å›¾ç‰‡åˆ‡æ¢åŠŸèƒ½
            if (level.type === 'image' && level.images && level.images.length > 0) {
                initImageGallery(level);
            }
        }

        // æ¸²æŸ“é€‰æ‹©é¢˜å…³å¡
        function renderQuizLevel(level) {
            const quiz = level.quiz || { questions: [] };
            const questions = quiz.questions || [];

            if (!questions.length) {
                return `
                    <div class="level-container active">
                        <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${level.title || 'é€‰æ‹©é¢˜å…³å¡'}</h2>
                        <div class="error">æ­¤é€‰æ‹©é¢˜å…³å¡æ²¡æœ‰é¢˜ç›®</div>
                    </div>
                `;
            }

            const qHtml = questions.map((q, qi) => {
                const type = q.type || 'single';
                const inputType = type === 'multi' ? 'checkbox' : 'radio';
                const options = q.options || [];
                const optsHtml = options.map((o, oi) => {
                    const id = `q${qi}_o${oi}`;
                    return `
                        <label for="${id}" style="display:flex; gap:10px; align-items:flex-start; padding:10px; border:1px solid #e5e7eb; border-radius:10px; margin:10px 0; cursor:pointer; background:#fff;">
                            <input id="${id}" name="q${qi}" type="${inputType}" value="${oi}" style="margin-top:3px;">
                            <span>${escapeHtml(o.text || '')}</span>
                        </label>
                    `;
                }).join('');

                return `
                    <div class="quiz-question" data-qi="${qi}" style="background:#f8f9fa; border-radius:12px; padding:16px; margin:16px 0;">
                        <div style="font-weight:700; margin-bottom:10px;">${qi + 1}. ${escapeHtml(q.prompt || '')}</div>
                        <div class="quiz-options">${optsHtml}</div>
                        <div class="quiz-feedback" style="display:none; margin-top:12px; padding:10px; border-radius:10px;"></div>
                    </div>
                `;
            }).join('');

            // æŠŠé¢˜åº“ä¸´æ—¶æŒ‚åˆ°windowï¼Œä¾›æäº¤æŒ‰é’®åˆ¤é¢˜
            window.__currentQuiz = { levelId: level.id, quiz };

            return `
                <div class="level-container active">
                    <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'é€‰æ‹©é¢˜å…³å¡')}</h2>
                    <p class="section-description" style="text-align: center; color: #666; margin-bottom: 20px;">${escapeHtml(level.description || '')}</p>

                    <div style="max-width: 900px; margin: 0 auto;">
                        ${qHtml}
                        <div style="text-align:center; margin-top: 20px;">
                            <button onclick="submitQuiz()" style="background:#667eea; color:#fff; border:none; padding:12px 18px; border-radius:12px; cursor:pointer; font-weight:700;">
                                æäº¤ç­”æ¡ˆ
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function escapeHtml(str) {
            if (!str) return '';
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }
        
        // è½¬ä¹‰æ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œé˜²æ­¢ä»£ç ç‰‡æ®µæ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
        function escapeForTemplate(str) {
            if (!str) return '';
            return String(str)
                .replace(/\\/g, '\\\\')
                .replace(/`/g, '\\`')
                .replace(/\${/g, '\\${');
        }

        // æäº¤å¹¶åˆ¤é¢˜
        window.submitQuiz = function() {
            const payload = window.__currentQuiz;
            if (!payload || !payload.quiz) return;
            const questions = payload.quiz.questions || [];

            questions.forEach((q, qi) => {
                const type = q.type || 'single';
                const options = q.options || [];
                const correct = options.map((o, oi) => (o && o.correct === true ? oi : null)).filter(v => v !== null);

                const selected = Array.from(document.querySelectorAll(`input[name="q${qi}"]:checked`)).map(el => Number(el.value));

                const isCorrect = (type === 'multi')
                    ? (selected.length === correct.length && selected.every(v => correct.includes(v)))
                    : (selected.length === 1 && correct.includes(selected[0]));

                const wrap = document.querySelector(`.quiz-question[data-qi="${qi}"] .quiz-feedback`);
                if (!wrap) return;
                wrap.style.display = 'block';
                wrap.style.border = isCorrect ? '1px solid #86efac' : '1px solid #fca5a5';
                wrap.style.background = isCorrect ? '#dcfce7' : '#fee2e2';
                const exp = q.explanation ? `<div style="margin-top:8px; color:#374151;"><strong>è§£æï¼š</strong>${escapeHtml(q.explanation)}</div>` : '';
                const correctLabels = correct.map(idx => options[idx] ? options[idx].text : '').filter(Boolean).map(escapeHtml).join('ã€');
                const selectedRationales = selected
                    .map(idx => options[idx] && options[idx].rationale ? options[idx].rationale : '')
                    .filter(Boolean)
                    .map(r => `<div style="margin-top:6px; color:#374151;"><strong>ä½ é€‰çš„ç†ç”±ï¼š</strong>${escapeHtml(r)}</div>`)
                    .join('');
                const hint = q.hint ? `<div style="margin-top:8px; color:#6b7280;"><strong>æç¤ºï¼š</strong>${escapeHtml(q.hint)}</div>` : '';
                wrap.innerHTML = `
                    <div style="font-weight:700; color:${isCorrect ? '#166534' : '#991b1b'};">
                        ${isCorrect ? 'æ­£ç¡®' : 'ä¸æ­£ç¡®'}ï¼ˆæ­£ç¡®ç­”æ¡ˆï¼š${correctLabels || 'æœªæ ‡æ³¨'}ï¼‰
                    </div>
                    ${selectedRationales}
                    ${exp}
                    ${hint}
                `;
            });
        };

        // æ¸²æŸ“å›¾ç‰‡å…³å¡
        function renderImageLevel(level) {
            const images = level.images || [];
            const texts = level.texts || [];
            
            // æ„å»ºå›¾ç‰‡URLï¼šå¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œéœ€è¦åŠ ä¸ŠAPIåŸºç¡€URL
            const getImageUrl = (imgPath) => {
                if (!imgPath) return '';
                // å¦‚æœå·²ç»æ˜¯å®Œæ•´URLï¼Œç›´æ¥è¿”å›
                if (imgPath.startsWith('http://') || imgPath.startsWith('https://')) {
                    return imgPath;
                }
                // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ„å»ºå®Œæ•´URL
                // Vercelç¯å¢ƒéœ€è¦é€šè¿‡APIæä¾›æ–‡ä»¶ï¼Œæœ¬åœ°ç¯å¢ƒå¯ä»¥ç›´æ¥è®¿é—®
                if (isLocal) {
                    return `http://localhost:3000${imgPath}`;
                } else {
                    // Vercelç¯å¢ƒï¼šé€šè¿‡APIæä¾›æ–‡ä»¶
                    // å°† /uploads/... è½¬æ¢ä¸º /api/uploads/...
                    if (imgPath.startsWith('/uploads/')) {
                        return `${API_BASE_URL}${imgPath.replace('/uploads', '/uploads')}`;
                    }
                    return `${API_BASE_URL.replace('/api', '')}${imgPath}`;
                }
            };
            
            let imagesHtml = images.map((img, index) => 
                `<img src="${getImageUrl(img)}" alt="å›¾ç‰‡${index + 1}" class="gallery-image ${index === 0 ? 'active' : ''}" data-index="${index}" onerror="this.style.display='none'; console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', '${img}');">`
            ).join('');
            
            let indicatorsHtml = images.map((_, index) => 
                `<div class="gallery-indicator ${index === 0 ? 'active' : ''}" onclick="goToImage(${index})"></div>`
            ).join('');
            
            return `
                <div class="level-container active">
                    <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${level.title || 'å›¾ç‰‡å…³å¡'}</h2>
                    <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${level.description || ''}</p>
                    
                    <div class="image-gallery">
                        <div class="image-wrapper">
                            ${imagesHtml}
                        </div>
                        ${images.length > 1 ? `
                            <button class="gallery-nav-button prev" onclick="previousImage()">â€¹</button>
                            <button class="gallery-nav-button next" onclick="nextImage()">â€º</button>
                        ` : ''}
                    </div>
                    
                    ${images.length > 1 ? `<div class="gallery-indicators">${indicatorsHtml}</div>` : ''}
                    
                    <div class="text-area">
                        <h3>å›¾ç‰‡è¯´æ˜</h3>
                        <div class="text-content" id="imageText">${texts[0] || ''}</div>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“è§†é¢‘å…³å¡
        function renderVideoLevel(level) {
            // æ„å»ºè§†é¢‘URL
            const getVideoUrl = (videoPath) => {
                if (!videoPath) return '';
                // å¦‚æœå·²ç»æ˜¯å®Œæ•´URLï¼Œç›´æ¥è¿”å›
                if (videoPath.startsWith('http://') || videoPath.startsWith('https://')) {
                    return videoPath;
                }
                // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ„å»ºå®Œæ•´URL
                if (isLocal) {
                    return `http://localhost:3000${videoPath}`;
                } else {
                    // Vercelç¯å¢ƒï¼šé€šè¿‡APIæä¾›æ–‡ä»¶
                    // å°† /uploads/... è½¬æ¢ä¸º /api/uploads/...
                    if (videoPath.startsWith('/uploads/')) {
                        return `${API_BASE_URL}${videoPath.replace('/uploads', '/uploads')}`;
                    }
                    return `${API_BASE_URL.replace('/api', '')}${videoPath}`;
                }
            };
            
            const videoUrl = getVideoUrl(level.videoUrl);
            
            return `
                <div class="level-container active">
                    <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'è§†é¢‘å…³å¡')}</h2>
                    <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${level.description || ''}</p>
                    
                    <div class="video-container">
                        <div class="video-wrapper">
                            <video controls>
                                <source src="${videoUrl}" type="video/mp4">
                                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
                            </video>
                        </div>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“Canvaså…³å¡
        async function renderCanvasLevel(level) {
            // æ–¹å¼0ï¼šå·²éƒ¨ç½²åº”ç”¨URLï¼ˆReact/Vite buildç­‰ï¼‰ï¼Œä¼˜å…ˆ iframe æ‰“å¼€
            if (level.appUrl && String(level.appUrl).trim()) {
                const appUrl = String(level.appUrl).trim();
                const iframeId = `iframe-${level.id}`;
                return {
                    html: `
                        <div class="level-container active">
                            <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'Canvaså…³å¡')}</h2>
                            <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${escapeHtml(level.description || '')}</p>

                            <div class="canvas-container" style="padding: 0; background: #000;">
                                <div class="canvas-wrapper" style="padding: 0;">
                                    <iframe
                                        id="${iframeId}"
                                        src="${appUrl}"
                                        style="width: 100%; height: 650px; border: none; border-radius: 8px; display: block; margin: 0 auto;"
                                        allow="camera; microphone; autoplay"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                            </div>
                        </div>
                    `,
                    code: null
                };
            }

            let code = level.code || '';
            
            // å¦‚æœæœ‰ä»£ç URLï¼Œä¼˜å…ˆåŠ è½½ä»£ç æ–‡ä»¶
            if (level.codeUrl) {
                try {
                    // æ„å»ºä»£ç æ–‡ä»¶URL
                    let codeUrl = level.codeUrl;
                    if (codeUrl.startsWith('/uploads/')) {
                        // Vercelç¯å¢ƒï¼šé€šè¿‡APIæä¾›æ–‡ä»¶
                        codeUrl = `${API_BASE_URL}${codeUrl.replace('/uploads', '/uploads')}`;
                    } else if (!codeUrl.startsWith('http://') && !codeUrl.startsWith('https://')) {
                        // ç›¸å¯¹è·¯å¾„
                        codeUrl = isLocal ? `http://localhost:3000${codeUrl}` : `${API_BASE_URL.replace('/api', '')}${codeUrl}`;
                    }
                    
                    const codeRes = await fetch(codeUrl);
                    if (codeRes.ok) {
                        const loadedCode = await codeRes.text();
                        if (loadedCode && loadedCode.trim()) {
                            code = loadedCode;
                        }
                    } else {
                        console.warn('åŠ è½½ä»£ç æ–‡ä»¶å¤±è´¥ï¼ŒçŠ¶æ€ç :', codeRes.status, 'URL:', codeUrl);
                    }
                } catch (error) {
                    console.error('åŠ è½½ä»£ç å¤±è´¥:', error, 'URL:', level.codeUrl);
                    // å¦‚æœåŠ è½½å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨level.code
                    if (!code && level.code) {
                        code = level.code;
                    }
                }
            }
            
            // å¦‚æœè¿˜æ˜¯æ²¡æœ‰ä»£ç ï¼Œæ˜¾ç¤ºé”™è¯¯
            if (!code || !code.trim()) {
                console.error('Canvaså…³å¡æ²¡æœ‰ä»£ç å†…å®¹');
                return {
                    html: `
                        <div class="level-container active">
                            <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'Canvaså…³å¡')}</h2>
                            <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${escapeHtml(level.description || '')}</p>
                            <div class="error" style="text-align: center; padding: 40px;">
                                <p>âš ï¸ Canvaså…³å¡ä»£ç æœªæ‰¾åˆ°æˆ–ä¸ºç©º</p>
                                <p style="margin-top: 10px; font-size: 14px; color: #666;">è¯·æ£€æŸ¥å…³å¡é…ç½®æˆ–é‡æ–°ä¸Šä¼ ä»£ç </p>
                            </div>
                        </div>
                    `,
                    code: null
                };
            }
            
            // æ£€æµ‹ä»£ç æ˜¯å¦æ˜¯å®Œæ•´çš„HTMLæ–‡æ¡£
            const isHTMLDocument = code.trim().startsWith('<!DOCTYPE') || 
                                   code.trim().startsWith('<html') || 
                                   code.includes('<html') ||
                                   code.includes('<!DOCTYPE');
            
            // æ£€æµ‹æ˜¯å¦æ˜¯Reactä»£ç ï¼ˆåŒ…å«importæˆ–JSXè¯­æ³•ï¼‰
            const isReactCode = code.includes('import ') || 
                               code.includes('from ') ||
                               (code.includes('<') && code.includes('/>')) ||
                               code.includes('React.createElement') ||
                               code.includes('useState') ||
                               code.includes('useEffect');
            
            const canvasId = `canvas-${level.id}`;
            const iframeId = `iframe-${level.id}`;
            
            // å¦‚æœæ˜¯Reactä»£ç ï¼Œä½¿ç”¨Babel Standaloneå®æ—¶è½¬è¯‘
            if (isReactCode && !isHTMLDocument) {
                console.log('æ£€æµ‹åˆ°Reactä»£ç ï¼Œä½¿ç”¨Babel Standaloneå®æ—¶è½¬è¯‘');
                
                // ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé¿å…æ¨¡æ¿å­—ç¬¦ä¸²åµŒå¥—é—®é¢˜
                const htmlHead = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Canvas</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }
        #root { width: 100%; height: 100vh; }
        .error { 
            color: #ff4444; 
            padding: 20px; 
            background: #ffe0e0; 
            border-radius: 8px;
            margin: 20px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;
        
        // ç”¨æˆ·ä»£ç 
`;
                // ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ç”Ÿæˆ htmlTail
                const htmlTail = `
        
        // è‡ªåŠ¨æ£€æµ‹å¹¶æ¸²æŸ“ç»„ä»¶ï¼ˆå¦‚æœä»£ç ä¸­æ²¡æœ‰è°ƒç”¨ ReactDOM.renderï¼‰
        setTimeout(() => {
            try {
                const rootElement = document.getElementById("root");
                
                // å¦‚æœ root è¿˜æ˜¯ç©ºçš„ï¼Œè¯´æ˜ä»£ç ä¸­æ²¡æœ‰è°ƒç”¨æ¸²æŸ“å‡½æ•°
                if (rootElement && rootElement.children.length === 0) {
                    let ComponentToRender = null;
                    
                    // å°è¯•æŸ¥æ‰¾å¸¸è§çš„ç»„ä»¶å
                    if (typeof App !== "undefined") {
                        ComponentToRender = App;
                    } else if (typeof Component !== "undefined") {
                        ComponentToRender = Component;
                    } else if (typeof MyComponent !== "undefined") {
                        ComponentToRender = MyComponent;
                    }
                    
                    // å¦‚æœæ‰¾åˆ°äº†ç»„ä»¶ï¼Œè‡ªåŠ¨æ¸²æŸ“
                    if (ComponentToRender) {
                        const root = ReactDOM.createRoot(rootElement);
                        root.render(React.createElement(ComponentToRender));
                    } else {
                        // å¦‚æœæ²¡æ‰¾åˆ°ï¼Œæ˜¾ç¤ºæç¤º
                        const errorMsg = '<div class="error"><strong>æœªæ‰¾åˆ°å¯æ¸²æŸ“çš„ç»„ä»¶</strong><br><br>è¯·ç¡®ä¿ï¼š<br>1. ä»£ç ä¸­å®šä¹‰äº†ç»„ä»¶ï¼ˆå¦‚ function App() {} æˆ– const App = () => {}ï¼‰<br>2. æˆ–è€…ç›´æ¥è°ƒç”¨ ReactDOM.render() æˆ– createRoot().render()<br><br>å¸¸è§ç»„ä»¶åï¼šApp, Component, MyComponent</div>';
                        rootElement.innerHTML = errorMsg;
                    }
                }
            } catch (e) {
                console.error("Reactä»£ç æ‰§è¡Œé”™è¯¯:", e);
                const rootElement = document.getElementById("root");
                if (rootElement) {
                    const errorStart = '<div class="error"><strong>ä»£ç æ‰§è¡Œé”™è¯¯:</strong><br>';
                    const errorEnd = '<br><br><strong>æç¤º:</strong><br>1. æ£€æŸ¥ä»£ç è¯­æ³•æ˜¯å¦æ­£ç¡®<br>2. ç¡®ä¿æ‰€æœ‰ import çš„ä¾èµ–éƒ½å·²é€šè¿‡ CDN åŠ è½½<br>3. å¦‚æœä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦åœ¨ HTML ä¸­å¼•å…¥å¯¹åº”çš„ CDN é“¾æ¥</div>';
                    rootElement.innerHTML = errorStart + e.message + errorEnd;
                }
            }
        }, 100);
    </script>
</body>
</html>`;
                
                // æ‹¼æ¥å®Œæ•´çš„HTML
                const reactHTML = htmlHead + code + htmlTail;
                
                const blob = new Blob([reactHTML], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                return {
                    html: `
                        <div class="level-container active">
                            <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'Canvaså…³å¡')}</h2>
                            <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${escapeHtml(level.description || '')}</p>
                            
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center; color: #1565c0; font-size: 14px;">
                                <p style="margin: 0 0 10px 0; font-weight: bold;">âš¡ å®æ—¶Reactæ¸²æŸ“</p>
                                <p style="margin: 0; font-size: 13px;">ä»£ç å·²é€šè¿‡Babel Standaloneå®æ—¶è½¬è¯‘å¹¶è¿è¡Œ</p>
                            </div>
                            
                            <div class="canvas-container" style="padding: 0; background: #000;">
                                <div class="canvas-wrapper" style="padding: 0;">
                                    <iframe 
                                        id="${iframeId}" 
                                        src="${blobUrl}" 
                                        style="width: 100%; height: 650px; border: none; border-radius: 8px; display: block; margin: 0 auto;"
                                        allow="camera; microphone; autoplay"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                            </div>
                        </div>
                    `,
                    code: null,
                    blobUrl: blobUrl
                };
            }
            
            // å¦‚æœæ˜¯HTMLæ–‡æ¡£ï¼Œä½¿ç”¨iframeåŠ è½½
            if (isHTMLDocument) {
                console.log('æ£€æµ‹åˆ°HTMLæ–‡æ¡£ï¼Œä½¿ç”¨iframeåŠ è½½');
                // åˆ›å»ºBlob URLæ¥åŠ è½½HTMLå†…å®¹
                const blob = new Blob([code], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                return {
                    html: `
                        <div class="level-container active">
                            <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${escapeHtml(level.title || 'Canvaså…³å¡')}</h2>
                            <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${escapeHtml(level.description || '')}</p>
                            
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center; color: #1565c0; font-size: 14px;">
                                <p style="margin: 0 0 10px 0; font-weight: bold;">ğŸ“· æ‘„åƒå¤´æƒé™æç¤º</p>
                                <p style="margin: 0; font-size: 13px;">æ­¤ARåº”ç”¨éœ€è¦è®¿é—®æ‚¨çš„æ‘„åƒå¤´ã€‚å½“æµè§ˆå™¨æç¤ºæ—¶ï¼Œè¯·ç‚¹å‡»"å…è®¸"ã€‚</p>
                            </div>
                            
                            <div class="canvas-container" style="padding: 0; background: #000;">
                                <div class="canvas-wrapper" style="padding: 0;">
                                    <iframe 
                                        id="${iframeId}" 
                                        src="${blobUrl}"
                                        style="width: 100%; height: 600px; border: none; border-radius: 8px; display: block; margin: 0 auto;"
                                        allow="camera; microphone; autoplay"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                            </div>
                            
                            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; color: #856404; font-size: 13px;">
                                <p style="margin: 0 0 8px 0; font-weight: bold;">ğŸ’¡ å¦‚æœæ‘„åƒå¤´æ— æ³•å¯åŠ¨ï¼Œè¯·å°è¯•ï¼š</p>
                                <ol style="margin: 0; padding-left: 20px; text-align: left;">
                                    <li>æ£€æŸ¥æµè§ˆå™¨åœ°å€æ å·¦ä¾§çš„é”å›¾æ ‡æˆ–æ‘„åƒå¤´å›¾æ ‡</li>
                                    <li>ç‚¹å‡»å›¾æ ‡ï¼Œé€‰æ‹©"å…è®¸"æ‘„åƒå¤´å’Œéº¦å…‹é£æƒé™</li>
                                    <li>å¦‚æœå·²ç»æ‹’ç»è¿‡ï¼Œè¯·åˆ·æ–°é¡µé¢å¹¶é‡æ–°æˆæƒ</li>
                                    <li>ç¡®ä¿æ²¡æœ‰å…¶ä»–åº”ç”¨æ­£åœ¨ä½¿ç”¨æ‘„åƒå¤´</li>
                                </ol>
                            </div>
                        </div>
                    `,
                    code: null, // HTMLæ–‡æ¡£ä¸éœ€è¦æ‰§è¡Œä»£ç 
                    blobUrl: blobUrl // ä¿å­˜blob URLä»¥ä¾¿åç»­æ¸…ç†
                };
            }
            
            // å¦‚æœæ˜¯çº¯JavaScriptä»£ç ï¼Œä½¿ç”¨canvas
            return {
                html: `
                    <div class="level-container active">
                        <h2 class="section-title" style="text-align: center; margin-bottom: 20px; color: #333;">${level.title || 'Canvaså…³å¡'}</h2>
                        <p class="section-description" style="text-align: center; color: #666; margin-bottom: 30px;">${level.description || ''}</p>
                        
                        <div class="canvas-container">
                            <div class="canvas-wrapper">
                                <canvas id="${canvasId}" width="800" height="600" style="width: 100%; max-width: 800px; height: auto; border: 1px solid #ddd; border-radius: 8px; display: block; margin: 0 auto;"></canvas>
                            </div>
                        </div>
                    </div>
                `,
                code: code
            };
        }

        // å›¾ç‰‡åˆ‡æ¢åŠŸèƒ½
        function initImageGallery(level) {
            currentImageIndex = 0;
            const images = level.images || [];
            const texts = level.texts || [];
            
            window.goToImage = (index) => {
                currentImageIndex = index;
                document.querySelectorAll('.gallery-image').forEach((img, i) => {
                    img.classList.toggle('active', i === index);
                });
                document.querySelectorAll('.gallery-indicator').forEach((ind, i) => {
                    ind.classList.toggle('active', i === index);
                });
                const textEl = document.getElementById('imageText');
                if (textEl) {
                    textEl.textContent = texts[index] || '';
                }
            };
            
            window.previousImage = () => {
                if (currentImageIndex > 0) {
                    goToImage(currentImageIndex - 1);
                }
            };
            
            window.nextImage = () => {
                if (currentImageIndex < images.length - 1) {
                    goToImage(currentImageIndex + 1);
                }
            };
        }

        // æ˜¾ç¤ºé”™è¯¯
        function showError(message) {
            const contentArea = document.getElementById('contentArea');
            const isLocalEnv = window.location.hostname === 'localhost' || 
                              window.location.hostname === '127.0.0.1' ||
                              window.location.hostname === '';
            
            let errorTips = '';
            if (isLocalEnv) {
                errorTips = `
                    è¯·ç¡®ä¿ï¼š<br>
                    1. åç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆcd backend && npm startï¼‰<br>
                    2. æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000<br>
                    3. å·²åœ¨ç®¡ç†ç«¯åˆ›å»ºäº†è¯¾ç¨‹å’Œå…³å¡
                `;
            } else {
                errorTips = `
                    <strong>çº¿ä¸Šç¯å¢ƒæç¤ºï¼š</strong><br>
                    1. åç«¯æœåŠ¡å°šæœªéƒ¨ç½²æˆ–é…ç½®<br>
                    2. è¯·éƒ¨ç½²åç«¯æœåŠ¡åˆ°äº‘å¹³å°ï¼ˆå¦‚ Vercelã€Railwayï¼‰<br>
                    3. éƒ¨ç½²åï¼Œä¿®æ”¹å‰ç«¯ä»£ç ä¸­çš„ PRODUCTION_API_URL ä¸ºå®é™…åç«¯åœ°å€<br>
                    4. å½“å‰é…ç½®çš„åç«¯åœ°å€ï¼š${API_BASE_URL}
                `;
            }
            
            contentArea.innerHTML = `<div class="error">
                <h3 style="margin-bottom: 10px;">âš ï¸ é”™è¯¯</h3>
                <p>${message}</p>
                <p style="margin-top: 15px; font-size: 14px; color: #666;">
                    ${errorTips}
                </p>
            </div>`;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', init);
    </script>
</body>
</html>
